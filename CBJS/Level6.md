Check source code 

![image](https://user-images.githubusercontent.com/115911041/227114395-b94f697b-c358-4756-9439-5c87102b5ad3.png)

Đầu tiên là sever vẫn check `MINE type` của file

Kế đó là mình thấy line thứ 14 và 15 có `$finfo` cùng với đó là biến [`finfo_open()`](https://www.php.net/manual/en/function.finfo-open.php) là mới khác với các level trước. Sau khi research thì mình biết là hàm `finfo_open()` với tham số `DILEINFO_MINE_TYPE` để lấy ra `magic_database` 

Ở line thứ 15 có hàm `finfo_file()` sẽ kiểm tra `MINE type` từ magic byte của file được upload và gán vào biến `$mine_type`

Line kế tiếp có biến `$whitelist` gồm `image/jpeg, image/png, image/gif`. Theo những gì mình nói ở [Readme](https://github.com/Llam-a/File-upload-Vulnerability#readme) có một lỗ hổng là `whitelist`- là nhửng danh sách file cho phép được tải lên

Vậy ở dòng tiếp theo, nếu `$mine_type` xuất hiện trong `$whitelist` thì upload sẽ thành công.

Kết luận là theo cách sever xử lý ở trên, để có thể bypass được filter thì cần phải thay đổi magic byte phù hợp với kiểu file `image`.

Mình sẽ dùng [magic bytes](https://en.wikipedia.org/wiki/List_of_file_signatures) của file GIF để chèn vào đầu file.

![image](https://user-images.githubusercontent.com/115911041/227118320-683e6743-1e7d-4a97-b4de-8e47d2fc5573.png)

Sau đó upload file

![image](https://user-images.githubusercontent.com/115911041/227118425-024ce79a-ea47-4829-9009-6211d7f97277.png)
